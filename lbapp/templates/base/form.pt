<metal:main use-macro="load: ../master.pt">
	<!-- Insere JavaScript -->
	<script metal:fill-slot="javascript" type="text/javascript" src=""></script>
	<div metal:fill-slot="conteudo" id="widgets">
		<title>LightBase - Base Form</title>
		<head>
			<link href="${request.route_url('home')}static/form/assets/css/custom.css" rel="stylesheet">
			<!--<script src="${request.route_url('home')}static/form/form.js"></script>
			<link rel="stylesheet" href="${request.route_url('home')}static/form/form.css" /> ->
			<!--[if lt IE 9]>
		    <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
		    <![endif]-->
		    
		    <script>
		    var baseJson = "";
		    function salvar(){
		    console.log("salvar ..."+baseJson);
		    bootbox.dialog("Deseja realmente salvar base?", [{
            "label": "Salvar",
            "class": "btn btn-succes",
            callback: function () {
                $.ajax({
                    type: 'post',
                    url: '/base/new',
                    data: {
                        json_base: baseJson
                    },
                    success: function (data, textStatus, jqXHR) {
                        bootbox.dialog("Obrigado! Sua base foi salva com sucesso!", [{
                            "label": "OK",
                            "class": "btn-small btn-primary",
                            "href": '/base/list',
                        }]);
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                             console.log(jqXHR, textStatus, errorThrown)
                             Utils.error('Por favor Tente novamente mais tarde!');
                    }
                });
            }
        }, {
            "label": "Cancelar",
            "class": "btn btn-danger",
        }]);
		    }		   		    
		    </script>
		    
		</head>
		<div class="container">
			<div class="row clearfix">
				<!-- Building Form. -->
				<div class="span6">
					<div class="clearfix">
						<h2>Nova Base</h2> <button type="button" id="save-data" onclick="salvar()">Salvar Base</button>
						<hr>
						<div id="build">
							<form id="target" class="form-horizontal"></form>
						</div>
					</div>
				</div>
				<!-- / Building Form. -->
				<!-- Components -->
				<div class="span6">
					<h2>Componentes</h2>
					<hr>
					<div class="tabbable">
						<ul class="nav nav-tabs" id="formtabs">
							<!-- Tab nav -->
						</ul>
						<form class="form-horizontal" id="components">
							<fieldset>
								<div class="tab-content">
									<!-- Tabs of snippets go here -->
								</div>
							</fieldset>
						</form>
					</div>
				</div>
				<!-- / Components -->
			</div><!-- <div class="row clearfix"> -->
		</div><!-- /container -->
		
		<script data-main="${request.route_url('home')}static/form/assets/js/main.js" 
		              src="${request.route_url('home')}static/form/assets/js/deps/require.js"></script>
		
	</div><!--  end <div metal:fill-slot="conteudo" id="widgets"> -->
</metal:main>

<script src="${request.route_url('home')}static/js/lib/utils.js"></script>
<script src="${request.route_url('home')}static/ace/assets/js/bootbox.min.js"></script>
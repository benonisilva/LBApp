<metal:main use-macro="load: ../master.pt">
    <!-- Insere JavaScript -->
    <script metal:fill-slot="javascript" type="text/javascript" src=""></script>
    <div metal:fill-slot="conteudo" id="widgets">
        <div class="row-fluid">
            <div class="span12">
                <div id="controller-data" style="display: none">
                    ${explorer}
                </div>
                <div id="base-explore"></div>
            </div>
        </div>
    </div>
</metal:main>
<script src="/static/js/lightbase/explorer.js"></script>
<script src="/static/ace-final/assets/js/jquery-ui-1.10.3.custom.min.js"></script>
<script src="/static/ace-final/assets/js/jquery.ui.touch-punch.min.js"></script>
<!--script src="/static/ace-final/assets/js/jquery.slimscroll.min.js"></script-->

<!--BOOTSRAP-EDITABLE STUFF-->
<link href="/static/bootstrap-editable-1.4.5/bootstrap-editable/css/bootstrap-editable.css" rel="stylesheet"/>
<link href="/static/bootstrap-editable-1.4.5/bootstrap-editable/img/clear.png" />
<link href="/static/bootstrap-editable-1.4.5/bootstrap-editable/img/loading.gif" />
<script src="/static/bootstrap-editable-1.4.5/bootstrap-editable/js/bootstrap-editable.min.js"></script>

<script src="/static/js/lightbase/jquery.jsonviewer.js"></script>

<script type="text/javascript">
    $(document).ready(function() {

        var explorer_data = JSON.parse($('#controller-data').text());

        var base_name = explorer_data['base_name'];
        var reg_model = JSON.parse(explorer_data['reg_model'].replace(/'/g, '"'));
        var registries = explorer_data['registries'];

        $('#base-explore').jsonviewer({ 
            base_name: base_name, 
            reg_model: reg_model,
            registries: registries 
        });

        $.fn.editable.defaults.mode = 'inline';

        $('.editable').each(function() { 
            // Makes everyone editable
            $(this).editable({
                //url: '/post',
                //title: 'XXXXXXXX'
                //type: 'text',
                pk: 1,
                name: 'somename',
            });
        });

        $(function() {
        
            /*$('#explorer').sortable({
                connectWith: '#explorer',
                opacity:0.8,
                revert:true,
                forceHelperSize:true,
                placeholder: 'accordion-placeholder',
                forcePlaceholderSize:true,
                tolerance:'pointer'
            });*/
        
        });


        function switch_editable(id){
            $('.editable').each(function() { 
                $(this).editable('toggleDisabled');
            });
        }

        $('.editable').on('hidden', function(e, reason){
                if(reason === 'save' || reason === 'nochange') {
                    var next = $(this).parent('td').next().find('.editable');
                    next.editable('show');
                }
           });
    });


</script>


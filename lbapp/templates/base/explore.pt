<metal:main use-macro="load: ../master.pt">
    <!-- Insere JavaScript -->
    <script metal:fill-slot="javascript" type="text/javascript" src=""></script>
    <div metal:fill-slot="conteudo" id="widgets">
    <title>LightBase - Explorar Bases</title>
        <div class="row-fluid">
            <div class="span12">

                <div id="controller-data" style="display: none">
                    ${explorer}
                </div>
                <div id="base-explorer" style="overflow: auto"></div>
            </div>
        </div>
    </div>
</metal:main>

<script src="/static/js/ace/bootbox.min.js"></script>
<script src="/static/ace-final/assets/js/jquery-ui-1.10.3.custom.min.js"></script>
<script src="/static/ace-final/assets/js/jquery.ui.touch-punch.min.js"></script>

<!--Bootstrap-Editable-->
<link href="/static/bootstrap-editable-1.4.6/bootstrap-editable/css/bootstrap-editable.css" rel="stylesheet"/>
<link href="/static/bootstrap-editable-1.4.6/bootstrap-editable/img/clear.png" />
<link href="/static/bootstrap-editable-1.4.6/bootstrap-editable/img/loading.gif" />
<script src="/static/bootstrap-editable-1.4.6/bootstrap-editable/js/bootstrap-editable.min.js"></script>

<!--Explorer-->
<script src="/static/js/lightbase/jquery.explorer.js"></script>
<link href="/static/css/lightbase/jquery.explorer.css" rel="stylesheet"/>

<script type="text/javascript">
    $(document).ready(function() {

        var explorer_data = JSON.parse($('#controller-data').text());

        var base = explorer_data['json_base']
        var registries = explorer_data['registries'];

        $.fn.editable.defaults.ajaxOptions = {type: "PUT"};
        $.fn.editable.defaults.mode = 'inline';
        $('#base-explorer').explorer({ 
            base: base,
            registries: registries 
        });

        function switch_editable(id){
            $('.editable').each(function() { 
                $(this).editable('toggleDisabled');
            });
        }

        $('.editable').on('hidden', function(e, reason){
                if(reason === 'save' || reason === 'nochange') {
                    var next = $(this).parent('td').next().find('.editable');
                    next.editable('show');
                }
           });
    });


</script>


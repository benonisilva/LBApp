<metal:main use-macro="load: acemaster.pt">

<script metal:fill-slot="javascript" type="text/javascript" src="static/codigo-nestable/Nestable/jquery.nestable.js"></script>

 <div metal:fill-slot="conteudo" id="widgets">

<header>
        <script type="text/javascript">
        $(document).ready(function()
        {

            $("#criarbase").click(function(){
                nest.create_field();
            });
            $("#criargrupo").click(function(){
                nest.create_group();
            });
            $("#context-delete").click(function(){
                nest.remove_element();
            });
            $("#nestable-refresh").click(function(){
                nest.refresh();
            });

            var updateOutput = function(e)
            {
                var list   = e.length ? e : $(e.target),
                    output = list.data('output');
                if (window.JSON) {
                    output.val(window.JSON.stringify(list.nestable('serialize')));//, null, 2));
                } else {
                    output.val('JSON browser support required for this demo.');
                }
            };

           var drop_callback = function(drop_info){
                nest.context.focus_on('base-context-' + drop_info.sourceId + '-form');
            }

            // activate Nestable for list 1
            $('#nestable').nestable({
                group: 1,
                maxDepth: 10,
                dropCallback: drop_callback
            })
            .on('change', updateOutput);

            
            // output initial serialised data
            updateOutput($('#nestable').data('output', $('#nestable-output')));

            $('#nestable-menu').on('click', function(e)
            {
                var target = $(e.target),
                    action = target.data('action');
                if (action === 'expand-all') {
                    $('.dd').nestable('expandAll');
                }
                if (action === 'collapse-all') {
                    $('.dd').nestable('collapseAll');
                }
            });


        });

        </script>
                                <!-- Linking CSS's -->

   <!--<link href="static/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css">-->
        <link rel="stylesheet" type="text/css" href="static/nestable-theme/jquery.nestable.css">
                                <!-- END Linking CSS's -->

</header>



               <div class="row-fluid">
                  <div class="span12">
                     <h3>Saída Serializada</h3>
                     <textarea id="nestable-output" class="m-wrap span12"></textarea>
                  </div>
               </div>


               <div class="row-fluid">    <!-- nestablelist 1 and 2 -->
                  <div class="span7">
                     <div class="widget">
                        <div class="widget-title">
                           <h4><i class="icon-edit"></i> Campos e Grupos</h4>

                           <div id="nestable-menu" class="tools">

                                <!-- Botão Criar -->
                             <button id="criarbase" type="button" class="btn btn-primary btn-small" data-loading-text="Carregando...">+ 1 Campo</button>
                             <button id="criargrupo" type="button" class="btn btn-primary btn-small" data-loading-text="Carregando...">+ 1 Grupo</button>
                                <!-- Fim Botão -->
                                <button type="button" class="btn btn-primary btn-small" data-action="expand-all">+ Expandir
                            <i class="icon-only icon-collapse-top bigger-110"></i>
                                </button>
                                <button type="button" class="btn btn-primary btn-small" data-loading-text="Carregando..." data-action="collapse-all">- Colapsar
                            <i class="icon-only icon-collapse bigger-110"></i>
                                </button>
                           <button id='nestable-refresh' class="btn btn-small" type="button">
                            <i class="icon-only icon-refresh bigger-110"></i>
                           </button>
                           </div>
                        </div>

                        <div id="div-to-scroll" class="widget-body" style="height:425px; overflow:auto;">
                           <div class="dd" id="nestable">
                              <ol id="ol1" class="dd-list">
                              </ol>
                           </div>
                        </div>  <!-- fim widget-body -->
                     </div>
                  </div>

                  <div class="span5">
                     <div class="widget">
                        <div class="widget-title">
                           <h4><i class="icon-cog"></i> Propriedades</h4>
                           <div class="tools">
                              <a href="javascript:;" class="collapse"></a>
                              <a href="http://www.keenthemes.com/preview/conquer/ui_elements_nestable.html#widget-config" data-toggle="modal" class="config"></a>
                              <a href="javascript:;" class="reload"></a>
                              <a href="javascript:;" class="remove"></a>
                           </div>
                        </div>
                           <div id="context-menu" class="tools">
                             <button id="context-delete" type="button" class="btn btn-small btn-danger">Deletar</button>
                           </div>
                        <div id="infobase2" class="widget-body" style="height:350px;">

                    <!-- DADOS DA BASE VÃO AQUI -->


        <script type="text/javascript" src="static/base_form.js"></script>

                        </div>
                     </div>
                  </div>

               </div>
            </div>
</metal:main>


